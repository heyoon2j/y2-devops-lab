description: |-
  # Automation Runbook : SelectRunbook
  * This Runbook executes specific child runbook or concurrently multi child runbook.

  ## Select Runbook
  * Single Runbook  ('isSingle' == true  / choice 'runbookName')
  * Multi Runbook ('isSingle' == false  / choice 'runbookGroupName')
schemaVersion: '0.3'
parameters:
  isSingle:
    type: Boolean
    description: 'true : Execute single runbook / false : Execute multi runbook'
    default: true
  runbookName:
    type: String
    description: If 'isSingle' is 'true', Select this value
    default: 'dummy'
    allowedValues: [
      'ExecuteTestA', 'ExecuteTestB', 'ExecuteTestC'
    ]
  runbookGroupName:
    type: String
    description: If 'isSingle' is 'false', Select this value
    default: 'dummy'
    allowedValues: [
      'rg-dr-test'
    ]
mainSteps:
  - name: SelectRunbook
    action: 'aws:branch'
    inputs:
      Choices:
        - NextStep: ExecuteRunbookGroup
          Variable: '{{ isSingle }}'
          BooleanEquals: false
      Default: ExecuteSingleRunbook
  - name: ExecuteSingleRunbook
    action: 'aws:executeAutomation'
    inputs:
      DocumentName: '{{ runbookName }}'
    nextStep: sleep10s
  - name: ExecuteRunbookGroup
    action: 'aws:executeAutomation'
    inputs:
      DocumentName: 'ExecuteRunbookGroup'
      MaxConcurrency: 100%
      MaxErrors: 100%
      TargetParameterName: 'runbookName'
      Targets:
        - Key: ResourceGroup
          Values:
            - '{{ runbookGroupName }}'
      RuntimeParameters:
        parameter1: 
        parameter2: 
    nextStep: sleep10s
  - name: sleep10s
    action: 'aws:sleep'
    inputs:
      Duration: PT10S
    isEnd: true
